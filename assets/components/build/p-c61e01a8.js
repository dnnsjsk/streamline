import{q as e,t as n,a as t,u as r,d as c,v as o,w as s,x as a,b as i}from"./p-ab4c0365.js";function l(n){const t=e(n);return function(e,r,c){let o;return r=n.iteratee(r),c?void 0!==(c=n.cloneDeep(c)).leafsOnly&&(c.leavesOnly=c.leafsOnly):c={},c=n.merge({checkCircular:!1,leavesOnly:void 0===c.childrenPath,pathFormat:"string"},c),t(e,((e,n,t,c)=>{if(r(e,n,t,c))return o={value:e,key:n,parent:t,context:c},c.break()}),{pathFormat:c.pathFormat,checkCircular:c.checkCircular,ownPropertiesOnly:c.ownPropertiesOnly,childrenPath:c.childrenPath,includeRoot:c.includeRoot,rootIsChildren:c.rootIsChildren,callbackAfterIterate:!1,leavesOnly:c.leavesOnly}),o}}const u=l(n),d=function(){const e=l(n);return function(n,t,r){return!!e(n,t,r)}}();function h(e){t.isProcessing=!0;const n=window.streamline||!1;fetch(n.ajax,{method:"POST",credentials:"same-origin",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"}),body:`action=streamlineQuery&type=${e.type}&query=${JSON.stringify(e.query)}&nonce=${n.nonce}&userId=${String(t.data.userId)}`}).then((e=>e&&e.json())).then((()=>{t.isProcessing=!1,e.callback&&e.callback()})).catch((()=>{console.log()}))}function f(e){for(var n=-1,t=null==e?0:e.length,r=0,c=[];++n<t;){var o=e[n];o&&(c[r++]=o)}return c}function p(e){const n=[...t.entriesFav],l=r(t[`entries${c(e.type)}`],(n=>e.filter(n)),{childrenPath:["children"]});if(e.favourite){const r=u(t.entriesFav,(n=>e.pathFav(n)),{childrenPath:["children"]});s(n,r.context._item.strPath);const c=r.context._item.parent.path;0===Object.values(a(t.entriesFav,`${c}.children`)).length&&s(n,c);const o=r.context._item.parent.parent.path;0===(!!o&&Object.values(a(t.entriesFav,`${o}.children`)).length)&&s(n,o);const l=1===n.length&&void 0===n[0]?[]:[...f(n)];t.entriesFav=l,t.entriesFavActive=l,i()}else{const r=u(t.entriesFav,(n=>e.path(n)),{childrenPath:["children"]}),c=null==r?void 0:r.key;if(0===t.entriesFav.length){const e=[...o(t.entriesFav,l)];t.entriesFav=e,t.entriesFavActive=e}else if(r){const e=o([Object.assign({},n[c])],l);n[c]=e[0],t.entriesFav=n,t.entriesFavActive=n}else{const e=[...n,l[0]];t.entriesFav=e,t.entriesFavActive=e}}t.test||h({type:"favourites",query:t.entriesFav}),e.callback&&e.callback()}export{p as a,u as b,h as f,d as s}